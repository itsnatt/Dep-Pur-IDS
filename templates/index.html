<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Intrusion Detection Prediction</title>
<h2 class="text-xl font-semibold">Purnamasari - 21.11.3850</h2>

    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="max-w-4xl mx-auto mt-10 p-6 bg-white rounded-2xl shadow-lg">
        <h1 class="text-2xl font-bold mb-4 text-center">Intrusion Detection System</h1>

        <form method="POST" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {% for field in [
                'dur', 'proto','service','state','spkts','dpkts','sbytes','dbytes',
                'rate','sttl','dttl','sload','dload','sloss','dloss','sinpkt',
                'dinpkt','sjit','djit','swin','stcpb','dtcpb','dwin','tcprtt',
                'synack','ackdat','smean','dmean','trans_depth','response_body_len',
                'ct_srv_src','ct_state_ttl','ct_dst_ltm','ct_src_dport_ltm',
                'ct_dst_sport_ltm','ct_dst_src_ltm','is_ftp_login','ct_ftp_cmd',
                'ct_flw_http_mthd','ct_src_ltm','ct_srv_dst','is_sm_ips_ports'
            ] %}
            <div>
                <label class="block text-sm font-semibold capitalize mb-1">{{ field.replace('_', ' ') }}</label>

                {% if field in ['proto', 'service', 'state'] %}
                <select name="{{ field }}" required class="w-full px-3 py-2 border border-gray-300 rounded-xl">
                    {% if field == 'proto' %}
                        <option value="tcp">tcp</option>
                        <option value="udp">udp</option>
                        <option value="icmp">icmp</option>
                    {% elif field == 'service' %}
                        <option value="http">http</option>
                        <option value="ftp">ftp</option>
                        <option value="-">-</option>
                    {% elif field == 'state' %}
                        <option value="FIN">FIN</option>
                        <option value="CON">CON</option>
                        <option value="INT">INT</option>
                    {% endif %}
                </select>
                {% else %}
                <input name="{{ field }}" type="number" step="any" required class="w-full px-3 py-2 border border-gray-300 rounded-xl">
                {% endif %}
            </div>
            {% endfor %}

            <div class="col-span-full text-center mt-4">
                <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-xl hover:bg-blue-700">Predict</button>
            </div>
        </form>

        {% if result %}
        <div class="mt-6 p-4 rounded-xl text-center
                    {{ 'bg-red-100 border border-red-300 text-red-800' if result.prediction == 1 else 'bg-green-100 border border-green-300 text-green-800' }}">
            <h2 class="text-xl font-semibold">Prediction Result</h2>
            <p class="text-2xl font-bold mt-2">
                {{ '⚠️ Attack Detected' if result.prediction == 1 else '✅ Normal Traffic' }}
            </p>
            <p class="mt-2 text-sm text-gray-600">Probability of Attack: {{ result.probability }}</p>
        </div>
        {% endif %}
    </div>
</body>
</html>
